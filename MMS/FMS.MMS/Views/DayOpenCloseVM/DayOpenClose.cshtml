@model MMS.Entities.ViewModels.FMS_DayOpenCloseVM

@{
    if (Model.Settings.CurrentDate == null)
    {
        ViewBag.Title = "Day Open";
    }

    else
    {
        ViewBag.Title = "Day Close";
    }
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<script type="text/javascript">
    $(document).ready(function () {
        $("#page-leftbar li").removeClass("active");
        $("#liAdmin").addClass("active");
        var navListItems = $('div.setup-panel div a'),
           allWells = $('.setup-content'),
           allNextBtn = $('.nextBtn');

        allWells.hide();

        navListItems.click(function (e) {
            e.preventDefault();
            var $target = $($(this).attr('href')),
                    $item = $(this);

            if (!$item.hasClass('disabled')) {
                navListItems.removeClass('btn-primary').addClass('btn-default');
                $item.addClass('btn-primary');
                allWells.hide();
                $target.show();
                $target.find('input:eq(0)').focus();
            }
        });

        allNextBtn.click(function () {
            var curStep = $(this).closest(".setup-content"),
                curStepBtn = curStep.attr("id"),
                nextStepWizard = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().next().children("a"),
                curInputs = curStep.find("input[type='text'],input[type='url']"),
                isValid = true;

            $(".form-group").removeClass("has-error");
            for (var i = 0; i < curInputs.length; i++) {
                if (!curInputs[i].validity.valid) {
                    isValid = false;
                    $(curInputs[i]).closest(".form-group").addClass("has-error");
                }
            }

            if (isValid)
                nextStepWizard.removeAttr('disabled').trigger('click');
        });

        $('div.setup-panel div a.btn-primary').trigger('click');
    });
    function DayOpenCloseConfirm() {

        var msg = '';
        if ('@Model.Settings.CurrentDate' == 'null' || '@Model.Settings.CurrentDate'=='') {
            msg = "Do You Want to Confirm Day Open?";
        }
        else {
            msg = "Do You Want to Confirm Day Close?";
        }
        if (confirm(msg)) {
            return true;
        }
        else
            return false;

    }
</script>
@section breadcrumb
{
    <li><a href="~/Dashboard/index">Dashboard</a></li>
    <li>Administration</li>
    <li class="active">Day Open Close</li>
}
@*@section title
    {
        @ViewBag.Title
    }*@

<style type="text/css">
    input, select, textarea {
        max-width: 100%;
    }

    .backTolist {
        font-size: 1em;
        font-weight: normal;
    }

        .backTolist:hover {
            text-decoration: none;
        }

    .fileSets {
        border: 1px dotted #ddd;
        margin: 0px 10px 20px 0;
        padding: 20px 10px 0px 10px;
    }

    .required:after {
        content: " *";
        color: #f00;
    }

    legend.scheduler-border {
        width: inherit; /* Or auto */
        padding: 0 10px; /* To give a bit of padding on the left and right */
        border-bottom: none;
    }

    body {
        margin-top: 40px;
    }

    .stepwizard-step p {
        margin-top: 10px;
    }

    .stepwizard-row {
        display: table-row;
    }

    .stepwizard {
        display: table;
        width: 100%;
        position: relative;
    }

    .stepwizard-step button[disabled] {
        opacity: 1 !important;
        filter: alpha(opacity=100) !important;
    }

    .stepwizard-row:before {
        top: 14px;
        bottom: 0;
        position: absolute;
        content: " ";
        width: 100%;
        height: 1px;
        background-color: #ccc;
        z-order: 0;
    }

    .stepwizard-step {
        display: table-cell;
        text-align: center;
        position: relative;
    }

    .btn-circle {
        width: 30px;
        height: 30px;
        text-align: center;
        padding: 6px 0;
        font-size: 12px;
        line-height: 1.428571429;
        border-radius: 15px;
    }
</style>
<p> @Html.ActionLink("Go Back to List", "Index", "DayOpenClose", null, new { @class = "btn btn-success btn-xs" })</p>
<hr />
<div class="container">
    <div class="stepwizard">
        <div class="stepwizard-row setup-panel">
            <div class="stepwizard-step">
                <a href="#step-1" type="button" class="btn btn-primary btn-circle">1</a>
                <p>Step 1</p>
            </div>
            <div class="stepwizard-step">
                <a href="#step-2" type="button" class="btn btn-default btn-circle" disabled="disabled">2</a>
                <p>Step 2</p>
            </div>
            <div class="stepwizard-step">
                <a href="#step-3" type="button" class="btn btn-default btn-circle" disabled="disabled">3</a>
                <p>Step 3</p>
            </div>
        </div>
    </div>
    @if (Model.Settings.CurrentDate == null)
    {
        <div class="row setup-content" id="step-1">
            <div class="col-xs-12">
                <div class="col-md-12">
                    <h3> Day Open Step 1</h3>
                    <div class="form-group">
                        <label class="control-label">Do You Want To Day Open?</label>
                        <input maxlength="100" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />

                    </div>
                    <div class="form-group">
                        <label class="control-label">Please Remember Day Open Date?</label>
                        <input maxlength="100" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                </div>
            </div>
        </div>
        <div class="row setup-content" id="step-2">
            <div class="col-xs-12">
                <div class="col-md-12">
                    <h3> Day Open Step 2</h3>
                    <div class="form-group">
                        <label class="control-label">Is Cash In Hand Closing Amount Correct? </label>
                        <input maxlength="200" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <div class="form-group">
                        <label class="control-label">Is Bank Account Closing Amount Correct?</label>
                        <input maxlength="200" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="row setup-content" id="step-1">
            <div class="col-xs-12">
                <div class="col-md-12">
                    <h3> Day Close Step 1</h3>
                    <div class="form-group">
                        <label class="control-label">Do You Want To Day Close?</label>
                        <input maxlength="100" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <div class="form-group">
                        <label class="control-label">Is All Voucher Approved?</label>
                        <input maxlength="100" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                </div>
            </div>
        </div>
        <div class="row setup-content" id="step-2">
            <div class="col-xs-12">
                <div class="col-md-12">
                    <h3> Day Close Step 2</h3>
                    <div class="form-group">
                        <label class="control-label">Is Cash In Hand Amount Correct? </label>
                        <input maxlength="200" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <div class="form-group">
                        <label class="control-label">Is Bank Account Amount Correct?</label>
                        <input maxlength="200" type="text" required="required" class="form-control" placeholder="Enter Yes/No" />
                    </div>
                    <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                </div>
            </div>
        </div>
    }
    <div class="row setup-content" id="step-3">
        @using (Html.BeginForm("DayOpenClose", "DayOpenCloseVM", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
        {
            @Html.AntiForgeryToken()
            @Html.ValidationSummary(true)
            @Html.HiddenFor(x => x.DayOpenClose.OpenedOn);
            @Html.HiddenFor(model => model.DayOpenClose.IsDayClosed)
            <div class="panel panel-info">

                <div class="panel-heading">

                    @ViewBag.Title.ToString()


                </div>
                <div class="panel-body">
                    <div class="row">
                        @if (Model.Settings.CurrentDate == null)
                        {
                            <h3> Day Open Step 3</h3>
                        }
                        else
                        {
                           <h3> Day Close Step 3</h3>
                        }
                        <div class="col-sm-8">
                            <fieldset class="fileSets">
                                <legend class="scheduler-border"></legend>
                                @if (Model.Settings.CurrentDate != null)
                                {
                                    <div class="form-group">
                                        @Html.Label("Close Date", new { @class = "col-sm-4 control-label required" })
                                        <div class="col-sm-4">
                                            <input class="form-control mask" readonly required data-inputmask="'alias': 'date'" value="@Model.DayOpenClose.OpenDate.Date" id="DayOpenClose.OpenDate" name="DayOpenClose.OpenDate" type="text" aria-required="true">
                                            @Html.ValidationMessageFor(model => model.DayOpenClose.OpenDate)
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-group">
                                        @Html.Label("Open Date", new { @class = "col-sm-4 control-label required" })
                                        <div class="col-sm-4">
                                            <input class="form-control mask" required data-inputmask="'alias': 'date'" value="" id="DayOpenClose.OpenDate" name="DayOpenClose.OpenDate" type="text" aria-required="true">
                                            @Html.ValidationMessageFor(model => model.DayOpenClose.OpenDate)
                                        </div>
                                    </div>
                                }
                            </fieldset>
                        </div>
                    </div>
                    <div class="row">
                        @if (Model.Settings.CurrentDate != null)
                        {
                            if (@Model.lstDayWiseCheckListDetails.Count > 0)
                            {
                                <table class="table table">
                                    <tbody>

                                        @for (var i = 0; i < Model.lstDayWiseCheckListDetails.Count; i++)
                                        {
                                            <tr>
                                                <td class="col-sm-4"></td>

                                                @if (!Model.lstDayWiseCheckListDetails[i].IsCheckListDone)
                                                {
                                                    <td class="col-sm-4">
                                                        @Html.CheckBoxFor(model => model.lstDayWiseCheckListDetails[i].IsCheckListDone, new { @disabled = "disabled" })
                                                        @Html.DisplayFor(model => model.lstDayWiseCheckListDetails[i].FMS_DayOpenCloseCheckList.Name)
                                                    </td>
                                                }
                                                else
                                                {
                                                    <td class="col-sm-4">
                                                        @Html.CheckBoxFor(model => model.lstDayWiseCheckListDetails[i].IsCheckListDone, new { @disabled = "disabled" })
                                                        @if (String.IsNullOrEmpty(@Model.lstDayWiseCheckListDetails[i].FMS_DayOpenCloseCheckList.ActionURL))
                                                        {
                                                            @Html.DisplayFor(model => model.lstDayWiseCheckListDetails[i].FMS_DayOpenCloseCheckList.Name)
                                                        }
                                                        else
                                                        {
                                                            <a href="@Model.lstDayWiseCheckListDetails[i].FMS_DayOpenCloseCheckList.ActionURL@Model.Settings.CurrentDate.Value.ToString("yyyy-MM-dd")"> @Html.DisplayFor(model => model.lstDayWiseCheckListDetails[i].FMS_DayOpenCloseCheckList.Name)</a>
                                                        }

                                                    </td>
                                                }
                                                <td class="col-sm-4"></td>

                                            </tr>
                                        }

                                    </tbody>
                                </table>
                            }

                        }

                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-sm-offset-3">
                            <div class="btn-toolbar">
                                @if (Model.Settings.CurrentDate == null)
                                {
                                    <input type="submit" value="Day Open" class="btn-primary btn" onclick=" return DayOpenCloseConfirm()" />
                                }
                                else
                                {
                                    <input type="submit" value="Day Close" class="btn-primary btn" onclick=" return DayOpenCloseConfirm()" />
                                }
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        }

        @*<div class="col-xs-12">
                <div class="col-md-12">
                    <h3> Step 3</h3>
                    <button class="btn btn-success btn-lg pull-right" type="submit">Finish!</button>
                </div>
            </div>*@
    </div>

</div>





@section Scripts {
    @Scripts.Render("~/bundles/Mask")
    @Scripts.Render("~/bundles/jqueryval")
}
